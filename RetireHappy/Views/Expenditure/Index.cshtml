@model IEnumerable<RetireHappy.Models.AvgExpenditure>

@{
    ViewBag.Title = "Index";
}

<div style="float:right">
    <p style="font-size:12px">Selected Expenditures</p>
    <ul id="expList" style="font-size:10px"></ul>
    <br>
    @using (Html.BeginForm("CalculatorStep3", "Users", FormMethod.Get))
    {
        <button class="btn btn-success" type="submit" id="Done">Done</button>
    }
</div>

<h2>Index</h2>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script>

    $(document).ready(function(){
        var addCount = 0;

        $("#Done").on('click', function () {
            // $('#myModal').modal('show');
            var liIds = $('#expList li').map(function (i, n) {
                return $(n).attr('id');
            }).get().join(',');
            //alert(liIds);

            //pass back to controller
            $.get('@Url.Action("Tabulate", "Expenditure")', { idArr: liIds });

        });
        ////http://www.codeproject.com/Tips/891309/Custom-Confirmation-Box-using-Bootstrap-Modal-Dial


        $("Button[id^='AddBtn_']").on('click', function () {


            if (addCount < 10) {
                var text = $(this).val();
                var arr = text.split(',');

                $(this).prop("disabled", true);
                $("Button[id^='RemBtn_" + arr[0] + "']").prop("disabled", false);
                $('#expList').append('<li id="'+arr[0]+'">' + arr[1]+ '</li>');
                addCount++;
            }
            else {
                alert("Added "+addCount+" Items already!");
            }
        });


        //});
            $("Button[id^='RemBtn_']").on('click', function(){
                var text =$(this).val();
                var arr = text.split(',');

                $(this).prop('disabled', true);
                $("Button[id^='AddBtn_" + arr[0] + "']").prop("disabled", false);

                $('li').filter(function () { return $.text([this]) === arr[1]; }).remove();
                addCount--;
            });

    });


</script>


@using (Html.BeginForm())
{
    <p>
        Find by name: @Html.TextBox("SearchString")
        <button type="submit" class="btn btn-default" value="Search">Search</button>
    </p>
}

<table class="table" style="height:80px;overflow:auto;">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.type)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.recordYear)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.avgAmount)
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.type)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.recordYear)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.avgAmount)
            </td>
            <td>
                <button class="btn btn-info" id="AddBtn_@Html.Raw(item.eId)" value="@Html.Raw(item.eId),@Html.Raw(item.type)">Add</button> |
                <button class="btn btn-default " id="RemBtn_@Html.Raw(item.eId)" value="@Html.Raw(item.eId),@Html.Raw(item.type)" disabled>Remove</button>

            </td>

        </tr>
    }

</table>
<!-- Modal -->